# ВКР САФУ. Генерация датасета с помощью GAN/Diffusion подходов

## Краткое описание
Проект разработан в виде MVP как демонстрация возможности воссоздания правдоподобных структур распределения торосистых образований на льдах арктики. Основная цель проекта заключается в максимальном удешевлении и ускорении исследований льдов, используя современный подход с применением генеративных нейронных сетей.
Суть работы заключется в том, что при подаче исходного снимка производится сдвиг в разные стороны известной области с определенным padding, далее происходит восстановление неизвестной-пустой области с помощью генеративной модели, тем самым создается синтетический новый снимок области, с сохранением фич исходного снимка области.
Пример обучения WGAN-GP архитектуры на ультра малом датасете:
<img width="426" height="659" alt="image" src="https://github.com/user-attachments/assets/8d34e68b-10ac-44df-813c-8a80014735e6" />

## Краткое объяснение исследований в рамках учебной деятельности
Для обучения моделей были даны исходные 9 аэрофотоснимков в формате GeoTIF (по сотрудничеству университета с проектом РосНефти). К этим снимкам заранее были приложены сегментированные бинарные маски торосов, которые далее и использовались. Перед тем, как перейти к построению архитектур и разработке, был проведен фрактальный анализ торосов. 

Фрактальный анализ масок производился для:
- вычисления коэфициента самоподобия (фрактальной размерности) этих структур,
- статистического отсеивания масок с высокой погрешностью сегментации на основе полученного коэфициента фрактальной размерности,
- на основе фрактальной размерности и координат широты и долготы сгруппировать маски и снимки по областям их съемки (данной информации не было предоставлено).
Всё это важно, в контексте исследования фрактальных структур, особенно с учётом места съемки, т.к. внешние условия во льдах, в разных областях, разные (например ветер, течение и т.д).

## Результат исследования снимков и масок
На основе проведенных исследований, снимки были разделены на 3 места съемки с помощью тепловой карты отдаления каждого снимка друг от друга. Также были выявлен 1 аномальный снимок неизвестного происхождения и исключены снимки с высокой погрешностью сегментации. По итогу в датасет вошло лишь 5 бинарных масок и снимков, что невероятно мало для обучения модели. 
Для решения проблемы с с недостатком данных были применены OnTheFly аугментации в процессе обучения, что позволило сильно увеличить датасет и получить хоть какой-то вменяемый результат.

# Общая информация
## Для обучения:
- Необходимо создать папку ./data/masks
- в папку masks необходимо поместить исходные бинарные маски торосов для обучения

На данном этапе, создана гибкая система кода, позволяющая внедрять изменения без глобальных изменений кода.

## Что есть:
- Препроцессинг входных данных с гибкой реализацией для простоты расширения способов предобработки,
- Аугментации,
- Реализация для тестирования разных гипер-параметров при обучении,
- Простейший GUI,
- Гибкая реализация обработчика датасета,
- Своя архитектура GAN с подходом WGAN-GP.
- Реализация Diffusion (DDPM) подхода.

  Проект разработан на базе Pytorch, без использования готовых предобученных моделей.
  Является учебным и первым проектом, на тему генерации изображений с помощью генеративных моделей.
  

БЫСТРЫЙ СТАРТ | Запуск через cli.py со следующими возможными аргументами:
- --train (запускает обучение модели с заданными параметрами)
- --load_weights (путь к подгружаемому чекпоинту)
- --gui (инференс с графическим интерфейсом)
